<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imperial Fly - Formulario VIP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #000, #1a1a1a, #000);
            color: #FFD700;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        @media (max-width: 640px) {
            body { padding: 0.5rem; }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background:
              radial-gradient(circle at 30% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
              radial-gradient(circle at 70% 80%, rgba(220, 20, 60, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .outer-container {
            display: flex;
            min-height: 100%;
            flex: 1 1 0%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            max-width: 800px;
            width: 100%;
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .outer-container { padding: 0.5rem; gap: 1.5rem; }
        }
        @media (max-width: 640px) {
            .outer-container { padding: 0.25rem; gap: 1rem; }
        }

        /* Video Section Styles */
        .video-section { width: 100%; max-width: 32rem; }

        .video-container {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 2rem;
            padding: 1.5rem;
            box-shadow:
                0 20px 25px -5px rgba(0, 0, 0, 0.1),
                0 10px 10px -5px rgba(0, 0, 0, 0.04),
                0 0 30px rgba(255, 215, 0, 0.3);
            animation: videoGlow 4s ease-in-out infinite alternate;
        }
        @media (max-width: 768px) { .video-container { padding: 1rem; border-radius: 1.5rem; } }
        @media (max-width: 640px) { .video-container { padding: 0.75rem; border-radius: 1rem; border-width: 1px; } }

        @keyframes videoGlow {
            0% { box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04), 0 0 30px rgba(255,215,0,.3); }
            100% { box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04), 0 0 50px rgba(255,215,0,.5); }
        }

        .video-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }
        @media (max-width: 768px) { .video-header { margin-bottom: 1rem; padding-bottom: .75rem; } }
        @media (max-width: 640px) { .video-header { margin-bottom: .75rem; padding-bottom: .5rem; } }

        .video-title {
            font-size: 24px;
            font-weight: bold;
            color: #FFD700;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8), 0 0 20px rgba(255, 215, 0, 0.6);
            margin-bottom: 8px;
        }
        @media (max-width: 768px) { .video-title { font-size: 18px; letter-spacing: 1px; } }
        @media (max-width: 640px) { .video-title { font-size: 16px; letter-spacing: .5px; margin-bottom: 6px; } }

        .video-subtitle {
            font-size: 16px;
            color: #DC143C;
            font-weight: 600;
            text-shadow: 0 0 8px rgba(220, 20, 60, 0.8);
        }
        @media (max-width: 768px) { .video-subtitle { font-size: 14px; } }
        @media (max-width: 640px) { .video-subtitle { font-size: 12px; } }

        /* Secci√≥n de pasos ANTES del video */
        .video-steps {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 1rem;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        @media (max-width: 768px) { .video-steps { margin-bottom: 1rem; padding: .75rem; border-radius: .75rem; } }
        @media (max-width: 640px) { .video-steps { margin-bottom: .75rem; padding: .5rem; border-radius: .5rem; } }

        .video-steps-title {
            font-size: 16px; font-weight: 600; color: #FFD700; margin-bottom: 1rem;
            text-shadow: 0 0 8px rgba(255,215,0,.6); display: flex; align-items: center; gap: .5rem;
        }
        @media (max-width: 768px) { .video-steps-title { font-size: 14px; margin-bottom: .75rem; } }
        @media (max-width: 640px) { .video-steps-title { font-size: 13px; margin-bottom: .5rem; gap: .25rem; } }

        .video-steps-list { list-style: none; padding: 0; }
        .video-steps-list li {
            padding: .5rem 0; font-size: 14px; color: #FFD700;
            text-shadow: 0 0 5px rgba(255,215,0,.4);
            transition: all .3s ease; display: flex; align-items: flex-start; gap: .5rem;
        }
        @media (max-width: 768px) { .video-steps-list li { font-size: 12px; padding: .4rem 0; } }
        @media (max-width: 640px) { .video-steps-list li { font-size: 11px; padding: .3rem 0; gap: .25rem; } }
        .video-steps-list li:hover { color: #DC143C; text-shadow: 0 0 8px rgba(220,20,60,.6); transform: translateX(5px); }
        @media (max-width: 640px) { .video-steps-list li:hover { transform: translateX(3px); } }
        .video-steps-list li::before { 
            content: '';
            flex-shrink: 0;
            width: 1.2em;
            height: 1.2em;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%2300D66A'%3E%3Cpath fill-rule='evenodd' d='M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z' clip-rule='evenodd'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }

        .video-player-wrapper {
            position: relative;
            width: 100%;
            border-radius: 1rem;
            overflow: hidden;
            background: #000;
            box-shadow:
                0 0 20px rgba(255, 215, 0, 0.3),
                inset 0 0 20px rgba(0, 0, 0, 0.5);
        }
        @media (max-width: 768px) { .video-player-wrapper { border-radius: .75rem; } }
        @media (max-width: 640px) { .video-player-wrapper { border-radius: .5rem; } }

        /* Bot√≥n de sonido */
        .sound-toggle-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            animation: pulse 2s ease-in-out infinite;
        }
        @media (max-width: 768px) { 
            .sound-toggle-btn { 
                width: 48px; 
                height: 48px; 
                bottom: 16px; 
                right: 16px; 
            } 
        }
        @media (max-width: 640px) { 
            .sound-toggle-btn { 
                width: 40px; 
                height: 40px; 
                bottom: 12px; 
                right: 12px;
                border-width: 1px;
            } 
        }

        @keyframes pulse {
            0%, 100% { 
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5), 0 0 0 0 rgba(255, 215, 0, 0.7); 
            }
            50% { 
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5), 0 0 0 10px rgba(255, 215, 0, 0); 
            }
        }

        .sound-toggle-btn:hover {
            background: rgba(220, 20, 60, 0.9);
            border-color: #FFD700;
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: none;
        }
        @media (max-width: 640px) { 
            .sound-toggle-btn:hover { transform: scale(1.05); } 
        }

        .sound-toggle-btn:active {
            transform: scale(0.95);
        }

        .sound-toggle-btn svg {
            width: 28px;
            height: 28px;
            color: #FFD700;
            transition: all 0.3s ease;
        }
        @media (max-width: 768px) { .sound-toggle-btn svg { width: 24px; height: 24px; } }
        @media (max-width: 640px) { .sound-toggle-btn svg { width: 20px; height: 20px; } }

        .sound-toggle-btn:hover svg {
            color: #FFF;
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.8));
        }

        .sound-toggle-btn.unmuted {
            background: rgba(220, 20, 60, 0.9);
            border-color: #FFD700;
            animation: none;
        }

        .sound-toggle-btn.unmuted svg {
            color: #FFD700;
        }

        /* Tooltip */
        .sound-toggle-btn::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: calc(100% + 10px);
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            color: #FFD700;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        @media (max-width: 640px) { 
            .sound-toggle-btn::before { 
                font-size: 10px; 
                padding: 6px 10px; 
            } 
        }

        .sound-toggle-btn:hover::before {
            opacity: 1;
        }

        .video-player { width: 100%; height: auto; display: block; background: #000; }

        /* Ocultar controles nativos del video */
        .video-player::-webkit-media-controls,
        .video-player::-webkit-media-controls-enclosure,
        .video-player::-webkit-media-controls-panel,
        .video-player::-webkit-media-controls-play-button,
        .video-player::-webkit-media-controls-start-playback-button { display: none !important; }

        .hidden { display: none !important; }

        /* BARRA ROJA DE PROGRESO (SINCRONIZADA) */
        .video-progress{
            position:absolute; bottom:0; left:0; height:4px; width:0%;
            background:#ff0000; /* Rojo s√≥lido */
            box-shadow:0 0 10px rgba(255,0,0,.7);
            transition:width .08s linear;
        }

        .step-circle-container {
            margin-left: auto; margin-right: auto; width: 100%; max-width: 28rem;
            border-radius: 2rem; background: rgba(0,0,0,.8);
            border: 2px solid rgba(255,215,0,.3);
            box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04), 0 0 30px rgba(255,215,0,.3);
            animation: containerGlow 4s ease-in-out infinite alternate;
        }
        @media (max-width: 768px) { .step-circle-container { border-radius: 1.5rem; border-width: 1px; } }
        @media (max-width: 640px) { .step-circle-container { border-radius: 1rem; } }

        @keyframes containerGlow {
            0% { box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04), 0 0 30px rgba(255,215,0,.3); }
            100% { box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04), 0 0 50px rgba(255,215,0,.5); }
        }

        .header { text-align: center; padding: 2rem 2rem 1rem 2rem; border-bottom: 1px solid rgba(255,215,0,.2); }
        @media (max-width: 768px) { .header { padding: 1.5rem 1rem .75rem 1rem; } }
        @media (max-width: 640px) { .header { padding: 1rem .75rem .5rem .75rem; } }

        .header h1 {
            font-size: 24px; font-weight: bold; color: #FFD700; text-transform: uppercase; letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255,215,0,.8), 0 0 20px rgba(255,215,0,.6); margin-bottom: 8px;
        }
        @media (max-width: 768px) { .header h1 { font-size: 18px; letter-spacing: 1px; } }
        @media (max-width: 640px) { .header h1 { font-size: 16px; letter-spacing: .5px; margin-bottom: 6px; } }

        .header p { font-size: 16px; color: #DC143C; font-weight: 600; text-shadow: 0 0 8px rgba(220,20,60,.8); }
        @media (max-width: 768px) { .header p { font-size: 14px; } }
        @media (max-width: 640px) { .header p { font-size: 12px; } }

        .step-indicator-row { display: flex; width: 100%; align-items: center; padding: 2rem; justify-content: center; }
        @media (max-width: 768px) { .step-indicator-row { padding: 1rem .5rem; } }
        @media (max-width: 640px) { .step-indicator-row { padding: .75rem .5rem; } }

        .step-content-default { position: relative; overflow: hidden; min-height: 200px; }
        @media (max-width: 768px) { .step-content-default { min-height: 180px; } }
        @media (max-width: 640px) { .step-content-default { min-height: 160px; } }

        .step-default {
            padding-left: 2rem; padding-right: 2rem; padding-bottom: 1rem;
            opacity: 1; transform: translateX(0); transition: all .4s ease-in-out;
        }
        @media (max-width: 768px) { .step-default { padding-left: 1rem; padding-right: 1rem; padding-bottom: .75rem; } }
        @media (max-width: 640px) { .step-default { padding-left: .75rem; padding-right: .75rem; padding-bottom: .5rem; } }

        .step-default.slide-out-left { opacity: 0; transform: translateX(-50%); }
        .step-default.slide-out-right { opacity: 0; transform: translateX(50%); }
        .step-default.slide-in-left { opacity: 0; transform: translateX(-100%); animation: slideInLeft .4s ease-out forwards; }
        .step-default.slide-in-right { opacity: 0; transform: translateX(100%); animation: slideInRight .4s ease-out forwards; }
        @keyframes slideInLeft { to { opacity: 1; transform: translateX(0); } }
        @keyframes slideInRight { to { opacity: 1; transform: translateX(0); } }

        .step-title {
            font-size: 20px; font-weight: bold; color: #FFD700; margin-bottom: 1.5rem; text-align: center;
            text-shadow: 0 0 10px rgba(255,215,0,.6);
        }
        @media (max-width: 768px) { .step-title { font-size: 16px; margin-bottom: 1rem; } }
        @media (max-width: 640px) { .step-title { font-size: 14px; margin-bottom: .75rem; } }

        .form-group { margin-bottom: 1.5rem; position: relative; }
        @media (max-width: 768px) { .form-group { margin-bottom: 1rem; } }
        @media (max-width: 640px) { .form-group { margin-bottom: .75rem; } }

        .form-label { display: block; font-size: 14px; font-weight: 600; color: #FFD700; margin-bottom: .5rem; text-shadow: 0 0 5px rgba(255,215,0,.5); }
        @media (max-width: 768px) { .form-label { font-size: 12px; } }
        @media (max-width: 640px) { .form-label { font-size: 11px; margin-bottom: .4rem; } }

        .form-input {
            width: 100%; padding: 12px 16px;
            border: 2px solid rgba(255,215,0,.3); border-radius: 8px;
            background: rgba(255,215,0,.05); color: #FFD700; font-size: 16px; transition: all .3s ease;
        }
        @media (max-width: 768px) { .form-input { padding: 10px 12px; font-size: 14px; } }
        @media (max-width: 640px) { .form-input { padding: 8px 10px; font-size: 14px; border-radius: 6px; border-width: 1px; } }

        .form-input:focus { outline: none; border-color: #FFD700; background: rgba(255,215,0,.1); box-shadow: 0 0 15px rgba(255,215,0,.3); }
        .form-input::placeholder { color: rgba(255,215,0,.5); }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        @media (max-width: 640px) { .form-row { grid-template-columns: 1fr; gap: .75rem; } }

        .phone-row { display: grid; grid-template-columns: 110px 1fr; gap: .5rem; }
        @media (max-width: 640px) { .phone-row { grid-template-columns: 90px 1fr; gap: .4rem; } }

        /* Autocomplete */
        .autocomplete-wrapper { position: relative; }
        .autocomplete-list {
            position: absolute; top: 100%; left: 0; right: 0;
            background: rgba(0,0,0,.95);
            border: 2px solid rgba(255,215,0,.5); border-top: none; border-radius: 0 0 8px 8px;
            max-height: 200px; overflow-y: auto; z-index: 1000; display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,.3);
        }
        @media (max-width: 768px) { .autocomplete-list { max-height: 150px; } }
        @media (max-width: 640px) { .autocomplete-list { max-height: 120px; border-radius: 0 0 6px 6px; border-width: 1px; } }
        .autocomplete-list.active { display: block; }
        .autocomplete-item { padding: 10px 16px; cursor: pointer; color: #FFD700; transition: all .2s ease; border-bottom: 1px solid rgba(255,215,0,.1); }
        @media (max-width: 768px) { .autocomplete-item { padding: 8px 12px; } }
        @media (max-width: 640px) { .autocomplete-item { padding: 6px 10px; } }
        .autocomplete-item:last-child { border-bottom: none; }
        .autocomplete-item:hover, .autocomplete-item.active { background: rgba(255,215,0,.2); color: #DC143C; text-shadow: 0 0 8px rgba(220,20,60,.6); }
        .autocomplete-item small { display: block; font-size: 12px; color: rgba(255,215,0,.7); margin-top: 2px; }
        @media (max-width: 768px) { .autocomplete-item small { font-size: 10px; } }
        @media (max-width: 640px) { .autocomplete-item small { font-size: 9px; margin-top: 1px; } }
        .autocomplete-list::-webkit-scrollbar { width: 8px; }
        @media (max-width: 640px) { .autocomplete-list::-webkit-scrollbar { width: 6px; } }
        .autocomplete-list::-webkit-scrollbar-track { background: rgba(0,0,0,.5); border-radius: 0 0 8px 0; }
        .autocomplete-list::-webkit-scrollbar-thumb { background: rgba(255,215,0,.5); border-radius: 4px; }
        .autocomplete-list::-webkit-scrollbar-thumb:hover { background: rgba(255,215,0,.7); }

        .footer-container { padding-left: 2rem; padding-right: 2rem; padding-bottom: 2rem; }
        @media (max-width: 768px) { .footer-container { padding-left: 1rem; padding-right: 1rem; padding-bottom: 1.5rem; } }
        @media (max-width: 640px) { .footer-container { padding-left: .75rem; padding-right: .75rem; padding-bottom: 1rem; } }

        .footer-nav { margin-top: 2.5rem; display: flex; }
        @media (max-width: 768px) { .footer-nav { margin-top: 1.5rem; } }
        @media (max-width: 640px) { .footer-nav { margin-top: 1rem; } }
        .footer-nav.spread { justify-content: space-between; }
        .footer-nav.end { justify-content: flex-end; }

        .back-button {
            transition: all 350ms; border: none; background: none; border-radius: .25rem;
            padding: .75rem 1rem; color: #a3a3a3; cursor: pointer; font-size: 16px; font-weight: 500;
        }
        @media (max-width: 768px) { .back-button { font-size: 14px; padding: .6rem .8rem; } }
        @media (max-width: 640px) { .back-button { font-size: 13px; padding: .5rem .6rem; } }
        .back-button:hover { color: #FFD700; text-shadow: 0 0 8px rgba(255,215,0,.6); }
        .back-button.inactive { pointer-events: none; opacity: .5; color: #a3a3a3; }

        .next-button {
            transition: all 350ms; display: flex; align-items: center; justify-content: center;
            border: none; border-radius: 9999px;
            background: linear-gradient(45deg, #DC143C, #B22222, #8B0000);
            color: #FFD700; font-weight: 500; letter-spacing: -0.025em;
            padding: .75rem 1.5rem; cursor: pointer; font-size: 16px; text-transform: uppercase;
            text-shadow: 0 0 8px rgba(255,215,0,.8);
            box-shadow: 0 0 15px rgba(220,20,60,.6), 0 0 30px rgba(220,20,60,.4);
        }
        @media (max-width: 768px) { .next-button { font-size: 14px; padding: .6rem 1.2rem; } }
        @media (max-width: 640px) { .next-button { font-size: 13px; padding: .5rem 1rem; } }
        .next-button:hover {
            background: linear-gradient(45deg, #FF1744, #DC143C, #B22222);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 0 25px rgba(220,20,60,.8), 0 0 50px rgba(220,20,60,.6);
            text-shadow: 0 0 15px rgba(255,215,0,1);
        }
        @media (max-width: 640px) { .next-button:hover { transform: translateY(-1px) scale(1.02); } }
        .next-button:active { transform: translateY(0) scale(1); }
        .next-button:disabled { opacity: .5; cursor: not-allowed; transform: none; }

        .step-indicator { position: relative; cursor: pointer; outline: none; transition: all .3s ease; }
        .step-indicator:hover .step-indicator-inner { transform: scale(1.1); }
        @media (max-width: 640px) { .step-indicator:hover .step-indicator-inner { transform: scale(1.05); } }

        .step-indicator-inner {
            display: flex; height: 2rem; width: 2rem; align-items: center; justify-content: center;
            border-radius: 9999px; font-weight: 600; transition: all .3s ease; border: 2px solid transparent;
        }
        @media (max-width: 768px) { .step-indicator-inner { height: 1.5rem; width: 1.5rem; } }
        @media (max-width: 640px) { .step-indicator-inner { height: 1.25rem; width: 1.25rem; border-width: 1px; } }

        .step-indicator-inner.inactive { background-color: #222; color: #a3a3a3; border-color: #444; }
        .step-indicator-inner.active { background-color: #FFD700; color: #000; border-color: #FFD700; box-shadow: 0 0 15px rgba(255,215,0,.8); }
        .step-indicator-inner.complete { background-color: #DC143C; color: #FFD700; border-color: #DC143C; box-shadow: 0 0 15px rgba(220,20,60,.6); }

        .active-dot { height: .75rem; width: .75rem; border-radius: 9999px; background-color: #000; }
        @media (max-width: 768px) { .active-dot { height: .5rem; width: .5rem; } }
        @media (max-width: 640px) { .active-dot { height: .4rem; width: .4rem; } }

        .step-number { font-size: .875rem; font-weight: bold; }
        @media (max-width: 768px) { .step-number { font-size: .75rem; } }
        @media (max-width: 640px) { .step-number { font-size: .65rem; } }

        .step-connector {
            position: relative; margin-left: .5rem; margin-right: .5rem; height: .125rem; flex: 1;
            overflow: hidden; border-radius: .25rem; background-color: #52525b;
        }
        @media (max-width: 768px) { .step-connector { margin-left: .25rem; margin-right: .25rem; } }
        @media (max-width: 640px) { .step-connector { margin-left: .2rem; margin-right: .2rem; height: .1rem; } }

        .step-connector-inner {
            position: absolute; left: 0; top: 0; height: 100%; background-color: #DC143C;
            transition: width .4s ease; box-shadow: 0 0 8px rgba(220,20,60,.6);
        }

        .check-icon { height: 1rem; width: 1rem; color: #FFD700; }
        @media (max-width: 768px) { .check-icon { height: .75rem; width: .75rem; } }
        @media (max-width: 640px) { .check-icon { height: .6rem; width: .6rem; } }

        .success-message { text-align: center; padding: 2rem; }
        @media (max-width: 768px) { .success-message { padding: 1.5rem; } }
        @media (max-width: 640px) { .success-message { padding: 1rem; } }

        .success-title {
            font-size: 24px; font-weight: bold; color: #FFD700; margin-bottom: 1rem;
            text-shadow: 0 0 15px rgba(255,215,0,.8);
        }
        @media (max-width: 768px) { .success-title { font-size: 18px; margin-bottom: .75rem; } }
        @media (max-width: 640px) { .success-title { font-size: 16px; margin-bottom: .5rem; } }

        .success-text { font-size: 16px; color: #DC143C; text-shadow: 0 0 8px rgba(220,20,60,.6); line-height: 1.5; }
        @media (max-width: 768px) { .success-text { font-size: 14px; } }
        @media (max-width: 640px) { .success-text { font-size: 12px; line-height: 1.4; } }

        .loading { display: flex; align-items: center; gap: .5rem; }
        @media (max-width: 640px) { .loading { gap: .3rem; } }

        .spinner { width: 16px; height: 16px; border: 2px solid rgba(255,215,0,.3); border-top: 2px solid #FFD700; border-radius: 50%; animation: spin 1s linear infinite; }
        @media (max-width: 640px) { .spinner { width: 14px; height: 14px; } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Validaci√≥n de errores */
        .form-input.error { border-color: #FF4444; background: rgba(255,68,68,.1); }
        .error-message { color: #FF4444; font-size: 12px; margin-top: .25rem; text-shadow: 0 0 5px rgba(255,68,68,.5); }
        @media (max-width: 768px) { .error-message { font-size: 10px; } }
        @media (max-width: 640px) { .error-message { font-size: 9px; margin-top: .2rem; } }

        /* PIE DE P√ÅGINA CON ENLACE AL SITIO WEB */
        .website-footer {
            text-align: center;
            padding: 1.5rem 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 215, 0, 0.2);
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0 0 2rem 2rem;
        }
        @media (max-width: 768px) {
            .website-footer { padding: 1rem 1rem; margin-top: 1.5rem; border-radius: 0 0 1.5rem 1.5rem; }
        }
        @media (max-width: 640px) {
            .website-footer { padding: .75rem .75rem; margin-top: 1rem; border-radius: 0 0 1rem 1rem; }
        }

        .website-footer-text {
            font-size: 14px;
            color: #FFD700;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        @media (max-width: 768px) { .website-footer-text { font-size: 12px; } }
        @media (max-width: 640px) { .website-footer-text { font-size: 11px; } }

        .website-footer-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: #DC143C;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 0 8px rgba(220, 20, 60, 0.6);
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background: rgba(220, 20, 60, 0.1);
        }
        @media (max-width: 768px) { .website-footer-link { font-size: 14px; padding: 0.4rem 0.8rem; } }
        @media (max-width: 640px) { .website-footer-link { font-size: 12px; padding: 0.3rem 0.6rem; gap: 0.3rem; } }

        .website-footer-link:hover {
            color: #FFD700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 1);
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-2px);
        }
        @media (max-width: 640px) { .website-footer-link:hover { transform: translateY(-1px); } }

        /* Touch */
        @media (hover:none) and (pointer:coarse){
            .next-button:hover { transform:none; }
            .next-button:active { transform:scale(.98); }
            .back-button:hover { color:#a3a3a3; text-shadow:none; }
            .back-button:active { color:#FFD700; }
            .website-footer-link:hover { transform: none; }
            .website-footer-link:active { transform: scale(0.95); }
        }
    </style>
</head>
<body>
    <div class="outer-container">
        <!-- Video Section -->
        <div class="video-section">
            <div class="video-container">
                <div class="video-header">
                    <h2 class="video-title">
                        <svg style="width: 24px; height: 24px; display: inline-block; vertical-align: middle; margin-right: 8px;" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"/>
                        </svg>
                        C√≥mo Agendar tu Cita VIP
                    </h2>
                    <p class="video-subtitle">Mira este video para entender el proceso</p>
                </div>

                <!-- Pasos ANTES del video -->
                <div class="video-steps">
                    <p class="video-steps-title">
                        <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle;" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
                        </svg>
                        En este video aprender√°s:
                    </p>
                    <ul class="video-steps-list">
                        <li>C√≥mo completar correctamente el formulario</li>
                        <li>Qu√© informaci√≥n necesitas tener lista</li>
                        <li>Cu√°ndo y c√≥mo te contactaremos</li>
                        <li>Los siguientes pasos del proceso VIP</li>
                    </ul>
                </div>

                <!-- Video Player -->
                <div class="video-player-wrapper" id="videoWrapper">
                    <video
                        class="video-player"
                        id="instructionVideo"
                        loop
                        playsinline
                        preload="auto"
                        muted
                    >
                        <source src="./assets/PASOS_IMPERIAL_FLY.mp4" type="video/mp4">
                        <p style="padding: 2rem; text-align: center; color: #FFD700;">
                            Tu navegador no soporta la reproducci√≥n de video.
                            <a href="./assets/PASOS_IMPERIAL_FLY.mp4" style="color: #DC143C;">Descarga el video aqu√≠</a>
                        </p>
                    </video>

                    <!-- Bot√≥n de control de sonido -->
                    <button class="sound-toggle-btn" id="soundToggleBtn" data-tooltip="Activar sonido" aria-label="Activar/Desactivar sonido">
                        <!-- Icono de volumen silenciado -->
                        <svg id="mutedIcon" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                        <!-- Icono de volumen activo (oculto por defecto) -->
                        <svg id="unmutedIcon" style="display: none;" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"/>
                        </svg>
                    </button>

                    <!-- Barra de progreso roja sincronizada -->
                    <div class="video-progress" id="videoProgress"></div>
                </div>
            </div>
        </div>

        <!-- Form Section -->
        <div class="step-circle-container">
            <!-- Header -->
            <div class="header">
                <h1>
                    <svg style="width: 28px; height: 28px; display: inline-block; vertical-align: middle; margin-right: 8px;" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                    </svg>
                    Imperial Fly VIP
                    <svg style="width: 28px; height: 28px; display: inline-block; vertical-align: middle; margin-left: 8px;" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                    </svg>
                </h1>
                <p>Registro para Acceso Exclusivo</p>
            </div>

            <!-- Step Indicators -->
            <div class="step-indicator-row">
                <div class="step-indicator" data-step="1">
                    <div class="step-indicator-inner active">
                        <div class="active-dot"></div>
                    </div>
                </div>
                <div class="step-connector"><div class="step-connector-inner" style="width: 0%"></div></div>
                <div class="step-indicator" data-step="2">
                    <div class="step-indicator-inner inactive"><span class="step-number">2</span></div>
                </div>
                <div class="step-connector"><div class="step-connector-inner" style="width: 0%"></div></div>
                <div class="step-indicator" data-step="3">
                    <div class="step-indicator-inner inactive"><span class="step-number">3</span></div>
                </div>
                <div class="step-connector"><div class="step-connector-inner" style="width: 0%"></div></div>
                <div class="step-indicator" data-step="4">
                    <div class="step-indicator-inner inactive"><span class="step-number">4</span></div>
                </div>
            </div>

            <!-- Form Content -->
            <form id="vipForm" action="https://formspree.io/f/mzzayqwe" method="POST">
                <div class="step-content-default">
                    <!-- Step 1: Nombre -->
                    <div class="step-default" id="step-1">
                        <div class="step-title">¬øCu√°l es tu nombre?</div>
                        <div class="form-group">
                            <label class="form-label" for="fullName">Nombre Completo *</label>
                            <input type="text" id="fullName" name="fullName" class="form-input" placeholder="Ingresa tu nombre completo" required />
                            <div class="error-message hidden" id="fullName-error"></div>
                        </div>
                    </div>

                    <!-- Step 2: WhatsApp -->
                    <div class="step-default hidden" id="step-2">
                        <div class="step-title">N√∫mero de WhatsApp</div>
                        <div class="form-group">
                            <label class="form-label">WhatsApp donde te contactaremos *</label>
                            <div class="phone-row">
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="countryCode" name="countryCode" class="form-input" placeholder="+52" required />
                                    <div class="autocomplete-list" id="countryCodeList"></div>
                                </div>
                                <input type="tel" id="whatsapp" name="whatsapp" class="form-input" placeholder="55 1234 5678" required />
                            </div>
                            <div class="error-message hidden" id="whatsapp-error"></div>
                        </div>
                    </div>

                    <!-- Step 3: Email -->
                    <div class="step-default hidden" id="step-3">
                        <div class="step-title">Correo Electr√≥nico</div>
                        <div class="form-group">
                            <label class="form-label" for="email">Email *</label>
                            <input type="email" id="email" name="email" class="form-input" placeholder="tu@email.com" required />
                            <div class="error-message hidden" id="email-error"></div>
                        </div>
                    </div>

                    <!-- Step 4: Viaje -->
                    <div class="step-default hidden" id="step-4">
                        <div class="step-title">Detalles del Viaje</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="origen">Ciudad de Origen *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="origen" name="origen" class="form-input" placeholder="Ciudad o Aeropuerto" required autocomplete="off" />
                                    <div class="autocomplete-list" id="origenList"></div>
                                </div>
                                <div class="error-message hidden" id="origen-error"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="fechaOrigen">Fecha de Salida *</label>
                                <input type="date" id="fechaOrigen" name="fechaOrigen" class="form-input" required />
                                <div class="error-message hidden" id="fechaOrigen-error"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="destino">Ciudad de Destino *</label>
                                <div class="autocomplete-wrapper">
                                    <input type="text" id="destino" name="destino" class="form-input" placeholder="Ciudad o Aeropuerto" required autocomplete="off" />
                                    <div class="autocomplete-list" id="destinoList"></div>
                                </div>
                                <div class="error-message hidden" id="destino-error"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="fechaDestino">Fecha de Regreso</label>
                                <input type="date" id="fechaDestino" name="fechaDestino" class="form-input" />
                                <div class="error-message hidden" id="fechaDestino-error"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div class="step-default hidden" id="success-step">
                        <div class="success-message">
                            <div class="success-title">¬°Registro Exitoso!</div>
                            <div class="success-text">
                                Gracias por registrarte en Imperial Fly VIP.<br>
                                Te contactaremos pronto en tu WhatsApp para ofrecerte las mejores ofertas exclusivas.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer Navigation -->
                <div class="footer-container" id="footer-nav">
                    <div class="footer-nav end" id="footer-buttons">
                        <button type="button" class="back-button inactive" id="backBtn">Anterior</button>
                        <button type="button" class="next-button" id="nextBtn"><span id="btnText">Continuar</span></button>
                    </div>
                </div>
            </form>

            <!-- PIE DE P√ÅGINA CON ENLACE AL SITIO WEB -->
            <div class="website-footer">
                <p class="website-footer-text">
                    <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin: 0 4px;" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
                    </svg>
                    Visita nuestro sitio web oficial y estate atento sobre nuestras promociones
                    <svg style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin: 0 4px;" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
                    </svg>
                </p>
                <a href="https://imperialfly.com/" target="_blank" rel="noopener noreferrer" class="website-footer-link">
                    <svg style="width: 20px; height: 20px;" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.977 5.977 0 0116 10c0 .34-.028.675-.083 1H15a2 2 0 00-2 2v2.197A5.973 5.973 0 0110 16v-2a2 2 0 00-2-2 2 2 0 01-2-2 2 2 0 00-1.668-1.973z" clip-rule="evenodd"/>
                    </svg>
                    <span>www.imperialfly.com</span>
                    <svg style="width: 20px; height: 20px;" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Base de datos de c√≥digos de pa√≠s (50+)
        const countryCodes = [
            { code: '+1', country: 'Estados Unidos/Canad√°', flag: 'üá∫üá∏' },
            { code: '+52', country: 'M√©xico', flag: 'üá≤üáΩ' },
            { code: '+34', country: 'Espa√±a', flag: 'üá™üá∏' },
            { code: '+44', country: 'Reino Unido', flag: 'üá¨üáß' },
            { code: '+33', country: 'Francia', flag: 'üá´üá∑' },
            { code: '+49', country: 'Alemania', flag: 'üá©üá™' },
            { code: '+39', country: 'Italia', flag: 'üáÆüáπ' },
            { code: '+351', country: 'Portugal', flag: 'üáµüáπ' },
            { code: '+54', country: 'Argentina', flag: 'üá¶üá∑' },
            { code: '+55', country: 'Brasil', flag: 'üáßüá∑' },
            { code: '+56', country: 'Chile', flag: 'üá®üá±' },
            { code: '+57', country: 'Colombia', flag: 'üá®üá¥' },
            { code: '+51', country: 'Per√∫', flag: 'üáµüá™' },
            { code: '+58', country: 'Venezuela', flag: 'üáªüá™' },
            { code: '+593', country: 'Ecuador', flag: 'üá™üá®' },
            { code: '+591', country: 'Bolivia', flag: 'üáßüá¥' },
            { code: '+598', country: 'Uruguay', flag: 'üá∫üáæ' },
            { code: '+595', country: 'Paraguay', flag: 'üáµüáæ' },
            { code: '+506', country: 'Costa Rica', flag: 'üá®üá∑' },
            { code: '+507', country: 'Panam√°', flag: 'üáµüá¶' },
            { code: '+503', country: 'El Salvador', flag: 'üá∏üáª' },
            { code: '+502', country: 'Guatemala', flag: 'üá¨üáπ' },
            { code: '+504', country: 'Honduras', flag: 'üá≠üá≥' },
            { code: '+505', country: 'Nicaragua', flag: 'üá≥üáÆ' },
            { code: '+509', country: 'Hait√≠', flag: 'üá≠üáπ' },
            { code: '+53', country: 'Cuba', flag: 'üá®üá∫' },
            { code: '+81', country: 'Jap√≥n', flag: 'üáØüáµ' },
            { code: '+82', country: 'Corea del Sur', flag: 'üá∞üá∑' },
            { code: '+86', country: 'China', flag: 'üá®üá≥' },
            { code: '+91', country: 'India', flag: 'üáÆüá≥' },
            { code: '+61', country: 'Australia', flag: 'üá¶üá∫' },
            { code: '+64', country: 'Nueva Zelanda', flag: 'üá≥üáø' },
            { code: '+7', country: 'Rusia', flag: 'üá∑üá∫' },
            { code: '+20', country: 'Egipto', flag: 'üá™üá¨' },
            { code: '+27', country: 'Sud√°frica', flag: 'üáøüá¶' },
            { code: '+971', country: 'Emiratos √Årabes', flag: 'üá¶üá™' },
            { code: '+966', country: 'Arabia Saudita', flag: 'üá∏üá¶' },
            { code: '+90', country: 'Turqu√≠a', flag: 'üáπüá∑' },
            { code: '+41', country: 'Suiza', flag: 'üá®üá≠' },
            { code: '+31', country: 'Pa√≠ses Bajos', flag: 'üá≥üá±' },
            { code: '+32', country: 'B√©lgica', flag: 'üáßüá™' },
            { code: '+43', country: 'Austria', flag: 'üá¶üáπ' },
            { code: '+45', country: 'Dinamarca', flag: 'üá©üá∞' },
            { code: '+46', country: 'Suecia', flag: 'üá∏üá™' },
            { code: '+47', country: 'Noruega', flag: 'üá≥üá¥' },
            { code: '+358', country: 'Finlandia', flag: 'üá´üáÆ' },
            { code: '+353', country: 'Irlanda', flag: 'üáÆüá™' },
            { code: '+30', country: 'Grecia', flag: 'üá¨üá∑' },
            { code: '+48', country: 'Polonia', flag: 'üáµüá±' },
            { code: '+420', country: 'Rep√∫blica Checa', flag: 'üá®üáø' },
        ];

        // Base de datos compacta de aeropuertos (extracto representativo)
        const airports = [
            // M√©xico
            { city: 'Ciudad de M√©xico', code: 'MEX', name: 'Aeropuerto Internacional Benito Ju√°rez', country: 'M√©xico' },
            { city: 'Canc√∫n', code: 'CUN', name: 'Aeropuerto Internacional de Canc√∫n', country: 'M√©xico' },
            { city: 'Guadalajara', code: 'GDL', name: 'Aeropuerto Internacional Miguel Hidalgo', country: 'M√©xico' },
            { city: 'Monterrey', code: 'MTY', name: 'Aeropuerto Internacional General Mariano Escobedo', country: 'M√©xico' },
            { city: 'Tijuana', code: 'TIJ', name: 'Aeropuerto Internacional General Abelardo L. Rodr√≠guez', country: 'M√©xico' },
            { city: 'Los Cabos', code: 'SJD', name: 'Aeropuerto Internacional de Los Cabos', country: 'M√©xico' },
            { city: 'Puerto Vallarta', code: 'PVR', name: 'Aeropuerto Internacional Lic. Gustavo D√≠az Ordaz', country: 'M√©xico' },
            { city: 'M√©rida', code: 'MID', name: 'Aeropuerto Internacional Manuel Crescencio Rej√≥n', country: 'M√©xico' },
            { city: 'Acapulco', code: 'ACA', name: 'Aeropuerto Internacional General Juan N. √Ålvarez', country: 'M√©xico' },
            { city: 'Ixtapa', code: 'ZIH', name: 'Aeropuerto Internacional de Ixtapa-Zihuatanejo', country: 'M√©xico' },
            // USA
            { city: 'Los √Ångeles', code: 'LAX', name: 'Aeropuerto Internacional de Los √Ångeles', country: 'Estados Unidos' },
            { city: 'Nueva York', code: 'JFK', name: 'Aeropuerto Internacional John F. Kennedy', country: 'Estados Unidos' },
            { city: 'Miami', code: 'MIA', name: 'Aeropuerto Internacional de Miami', country: 'Estados Unidos' },
            { city: 'Dallas', code: 'DFW', name: 'Aeropuerto Internacional Dallas/Fort Worth', country: 'Estados Unidos' },
            // Europa
            { city: 'Madrid', code: 'MAD', name: 'Adolfo Su√°rez Madrid-Barajas', country: 'Espa√±a' },
            { city: 'Barcelona', code: 'BCN', name: 'Barcelona-El Prat', country: 'Espa√±a' },
            { city: 'Par√≠s', code: 'CDG', name: 'Charles de Gaulle', country: 'Francia' },
            { city: 'Londres', code: 'LHR', name: 'Heathrow', country: 'Reino Unido' },
            { city: 'Roma', code: 'FCO', name: 'Fiumicino', country: 'Italia' },
            // Otros
            { city: 'Bogot√°', code: 'BOG', name: 'El Dorado', country: 'Colombia' },
            { city: 'Lima', code: 'LIM', name: 'Jorge Ch√°vez', country: 'Per√∫' },
            { city: 'Santiago', code: 'SCL', name: 'Arturo Merino Ben√≠tez', country: 'Chile' },
            { city: 'Buenos Aires', code: 'EZE', name: 'Ministro Pistarini', country: 'Argentina' },
            { city: 'Tokio', code: 'HND', name: 'Haneda', country: 'Jap√≥n' }
        ];

        // Autocomplete
        class Autocomplete {
            constructor(inputId, listId, data, displayFn) {
                this.input = document.getElementById(inputId);
                this.list = document.getElementById(listId);
                this.data = data;
                this.displayFn = displayFn;
                this.currentFocus = -1;
                this.init();
            }
            init() {
                this.input.addEventListener('input', (e) => this.handleInput(e));
                this.input.addEventListener('keydown', (e) => this.handleKeydown(e));
                this.input.addEventListener('focus', () => this.showAllOptions());
                document.addEventListener('click', (e) => { if (e.target !== this.input) this.closeList(); });
            }
            handleInput(e) {
                const val = e.target.value.trim();
                this.closeList();
                if (!val) { this.showAllOptions(); return; }
                this.currentFocus = -1;
                const filtered = this.data.filter(item => this.displayFn(item).toLowerCase().includes(val.toLowerCase()));
                if (filtered.length > 0) {
                    this.list.classList.add('active');
                    filtered.slice(0, 10).forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'autocomplete-item';
                        div.innerHTML = this.displayFn(item);
                        div.addEventListener('click', () => this.selectItem(item));
                        this.list.appendChild(div);
                    });
                }
            }
            showAllOptions() {
                this.closeList();
                this.currentFocus = -1;
                const displayData = this.data.slice(0, 10);
                if (displayData.length > 0) {
                    this.list.classList.add('active');
                    displayData.forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'autocomplete-item';
                        div.innerHTML = this.displayFn(item);
                        div.addEventListener('click', () => this.selectItem(item));
                        this.list.appendChild(div);
                    });
                }
            }
            handleKeydown(e) {
                const items = this.list.getElementsByClassName('autocomplete-item');
                if (e.keyCode === 40) { e.preventDefault(); this.currentFocus++; this.setActive(items); }
                else if (e.keyCode === 38) { e.preventDefault(); this.currentFocus--; this.setActive(items); }
                else if (e.keyCode === 13) { e.preventDefault(); if (this.currentFocus > -1 && items[this.currentFocus]) items[this.currentFocus].click(); }
                else if (e.keyCode === 27) { this.closeList(); }
            }
            setActive(items) {
                if (!items) return;
                this.removeActive(items);
                if (this.currentFocus >= items.length) this.currentFocus = 0;
                if (this.currentFocus < 0) this.currentFocus = items.length - 1;
                items[this.currentFocus].classList.add('active');
                items[this.currentFocus].scrollIntoView({ block: 'nearest' });
            }
            removeActive(items) { for (let item of items) item.classList.remove('active'); }
            selectItem(item) {
                if (this.input.id === 'countryCode') this.input.value = item.code;
                else this.input.value = `${item.city} (${item.code})`;
                this.closeList();
                const nextInput = this.input.closest('.form-group')?.querySelector('input[type="date"], input[type="tel"]');
                if (nextInput) setTimeout(() => nextInput.focus(), 100);
            }
            closeList() { this.list.innerHTML = ''; this.list.classList.remove('active'); this.currentFocus = -1; }
        }

        // Stepper Form
        class StepperForm {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 4;
                this.direction = 0;
                this.formData = {};

                this.nextBtn = document.getElementById('nextBtn');
                this.backBtn = document.getElementById('backBtn');
                this.btnText = document.getElementById('btnText');
                this.footerNav = document.getElementById('footer-nav');

                this.initializeEventListeners();
                this.initializeAutocomplete();
                this.updateStepDisplay();
            }

            initializeAutocomplete() {
                new Autocomplete('countryCode','countryCodeList',countryCodes,(i)=>`${i.flag} ${i.code} - ${i.country}`);
                new Autocomplete('origen','origenList',airports,(i)=>`${i.city} (${i.code})<small>${i.name}, ${i.country}</small>`);
                new Autocomplete('destino','destinoList',airports,(i)=>`${i.city} (${i.code})<small>${i.name}, ${i.country}</small>`);
                document.getElementById('countryCode').value = '+52';
            }

            initializeEventListeners() {
                this.nextBtn.addEventListener('click', () => this.handleNext());
                this.backBtn.addEventListener('click', () => this.handleBack());
                document.querySelectorAll('.form-input').forEach(input => {
                    input.addEventListener('input', () => this.clearError(input.id));
                    input.addEventListener('blur', () => this.validateField(input.id));
                });
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !this.nextBtn.disabled) {
                        const activeElement = document.activeElement;
                        if (!activeElement.classList.contains('autocomplete-item')) {
                            e.preventDefault();
                            this.handleNext();
                        }
                    }
                });
            }

            validateField(fieldId) {
                const field = document.getElementById(fieldId);
                if (!field) return true;
                const value = field.value.trim();
                let isValid = true, errorMessage = '';

                switch (fieldId) {
                    case 'fullName':
                        if (!value) { errorMessage = 'El nombre es requerido'; isValid = false; }
                        else if (value.length < 2) { errorMessage = 'El nombre debe tener al menos 2 caracteres'; isValid = false; }
                        break;
                    case 'countryCode':
                        if (!value) { errorMessage = 'El c√≥digo de pa√≠s es requerido'; isValid = false; }
                        else if (!value.startsWith('+')) { errorMessage = 'El c√≥digo debe comenzar con +'; isValid = false; }
                        break;
                    case 'whatsapp':
                        if (!value) { errorMessage = 'El n√∫mero de WhatsApp es requerido'; isValid = false; }
                        else if (value.length < 8) { errorMessage = 'Ingresa un n√∫mero v√°lido'; isValid = false; }
                        break;
                    case 'email':
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!value) { errorMessage = 'El email es requerido'; isValid = false; }
                        else if (!emailRegex.test(value)) { errorMessage = 'Ingresa un email v√°lido'; isValid = false; }
                        break;
                    case 'origen':
                        if (!value) { errorMessage = 'La ciudad de origen es requerida'; isValid = false; }
                        break;
                    case 'fechaOrigen':
                        if (!value) { errorMessage = 'La fecha de salida es requerida'; isValid = false; }
                        else if (new Date(value) < new Date(new Date().toDateString())) { errorMessage = 'La fecha debe ser futura'; isValid = false; }
                        break;
                    case 'destino':
                        if (!value) { errorMessage = 'La ciudad de destino es requerida'; isValid = false; }
                        break;
                    case 'fechaDestino':
                        if (value) {
                            const fechaOrigen = document.getElementById('fechaOrigen').value;
                            if (fechaOrigen && new Date(value) <= new Date(fechaOrigen)) {
                                errorMessage = 'La fecha de regreso debe ser posterior a la salida'; isValid = false;
                            }
                        }
                        break;
                }
                this.showError(fieldId, errorMessage, !isValid);
                return isValid;
            }

            showError(fieldId, message, show = true) {
                const field = document.getElementById(fieldId);
                const errorDiv = document.getElementById(`${fieldId}-error`);
                if (!field || !errorDiv) return;
                if (show && message) { field.classList.add('error'); errorDiv.textContent = message; errorDiv.classList.remove('hidden'); }
                else { field.classList.remove('error'); errorDiv.classList.add('hidden'); }
            }

            clearError(fieldId) { this.showError(fieldId, '', false); }

            validateCurrentStep() {
                const stepFields = this.getStepFields(this.currentStep);
                let isValid = true;
                stepFields.forEach(fieldId => { if (!this.validateField(fieldId)) isValid = false; });
                return isValid;
            }

            getStepFields(step) {
                const fieldMap = { 1: ['fullName'], 2: ['countryCode','whatsapp'], 3: ['email'], 4: ['origen','fechaOrigen','destino'] };
                return fieldMap[step] || [];
            }

            async handleNext() {
                if (this.currentStep <= this.totalSteps) {
                    if (!this.validateCurrentStep()) return;
                    this.saveStepData();
                    if (this.currentStep === this.totalSteps) {
                        await this.submitForm();
                    } else {
                        this.direction = 1;
                        this.currentStep++;
                        this.updateStepDisplay();
                    }
                }
            }

            handleBack() {
                if (this.currentStep > 1) {
                    this.direction = -1;
                    this.currentStep--;
                    this.updateStepDisplay();
                }
            }

            saveStepData() {
                const stepFields = this.getStepFields(this.currentStep);
                stepFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    if (field) this.formData[fieldId] = field.value;
                });
            }

            updateStepDisplay() {
                this.updateIndicators();
                this.updateStepContent();
                this.updateButtons();
            }

            updateIndicators() {
                const indicators = document.querySelectorAll('.step-indicator');
                const connectors = document.querySelectorAll('.step-connector-inner');
                indicators.forEach((indicator, index) => {
                    const stepNumber = index + 1;
                    const inner = indicator.querySelector('.step-indicator-inner');
                    if (stepNumber < this.currentStep) {
                        inner.className = 'step-indicator-inner complete';
                        inner.innerHTML = '<svg class="check-icon" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg>';
                    } else if (stepNumber === this.currentStep) {
                        inner.className = 'step-indicator-inner active';
                        inner.innerHTML = '<div class="active-dot"></div>';
                    } else {
                        inner.className = 'step-indicator-inner inactive';
                        inner.innerHTML = `<span class="step-number">${stepNumber}</span>`;
                    }
                });
                connectors.forEach((connector, index) => {
                    const progress = this.currentStep > index + 1 ? 100 : 0;
                    connector.style.width = `${progress}%`;
                });
            }

            updateStepContent() {
                const currentStepEl = document.getElementById(`step-${this.currentStep}`);
                const allSteps = document.querySelectorAll('.step-default:not(#success-step)');
                allSteps.forEach(step => { if (step !== currentStepEl) step.classList.add('hidden'); });
                if (currentStepEl) {
                    currentStepEl.classList.remove('hidden');
                    if (this.direction !== 0) {
                        currentStepEl.classList.remove('slide-in-left','slide-in-right');
                        currentStepEl.classList.add(this.direction > 0 ? 'slide-in-right' : 'slide-in-left');
                    }
                    const firstInput = currentStepEl.querySelector('.form-input');
                    if (firstInput) setTimeout(() => firstInput.focus(), 100);
                }
            }

            updateButtons() {
                if (this.currentStep === 1) {
                    this.backBtn.classList.add('inactive');
                    document.querySelector('.footer-nav').classList.remove('spread');
                    document.querySelector('.footer-nav').classList.add('end');
                } else {
                    this.backBtn.classList.remove('inactive');
                    document.querySelector('.footer-nav').classList.remove('end');
                    document.querySelector('.footer-nav').classList.add('spread');
                }
                this.btnText.textContent = this.currentStep === this.totalSteps ? 'Enviar Registro' : 'Continuar';
            }

            async submitForm() {
                this.btnText.innerHTML = '<div class="loading"><div class="spinner"></div><span>Enviando...</span></div>';
                this.nextBtn.disabled = true;
                try {
                    this.saveStepData();
                    const formData = new FormData();
                    const fullPhone = `${this.formData.countryCode} ${this.formData.whatsapp}`;
                    formData.append('whatsapp', fullPhone);
                    formData.append('fullName', this.formData.fullName);
                    formData.append('email', this.formData.email);
                    formData.append('origen', this.formData.origen);
                    formData.append('fechaOrigen', this.formData.fechaOrigen);
                    formData.append('destino', this.formData.destino);
                    const fechaDestino = document.getElementById('fechaDestino').value;
                    if (fechaDestino) formData.append('fechaDestino', fechaDestino);

                    const response = await fetch('https://formspree.io/f/mzzayqwe', {
                        method: 'POST',
                        body: formData,
                        headers: { 'Accept': 'application/json' }
                    });
                    if (response.ok) this.showSuccess();
                    else throw new Error('Error en el env√≠o');
                } catch (error) {
                    console.error('Error:', error);
                    alert('Hubo un error al enviar el formulario. Por favor, int√©ntalo de nuevo.');
                    this.btnText.textContent = 'Enviar Registro';
                    this.nextBtn.disabled = false;
                }
            }

            showSuccess() {
                document.querySelectorAll('.step-default:not(#success-step)').forEach(step => step.classList.add('hidden'));
                document.getElementById('success-step').classList.remove('hidden');
                this.footerNav.classList.add('hidden');
                this.currentStep = this.totalSteps + 1;
                this.updateIndicators();
            }
        }

        // --- SISTEMA DE AUTOPLAY MEJORADO CON SONIDO ---
        function initVideoPlayer() {
            const video = document.getElementById('instructionVideo');
            const progressBar = document.getElementById('videoProgress');
            const soundBtn = document.getElementById('soundToggleBtn');
            const mutedIcon = document.getElementById('mutedIcon');
            const unmutedIcon = document.getElementById('unmutedIcon');
            
            if (!video || !soundBtn) return;

            // El video inicia silenciado para garantizar autoplay
            video.muted = true;

            // Funci√≥n para alternar sonido
            function toggleSound() {
                video.muted = !video.muted;
                updateSoundButton();
            }

            // Actualizar visualizaci√≥n del bot√≥n
            function updateSoundButton() {
                if (video.muted) {
                    mutedIcon.style.display = 'block';
                    unmutedIcon.style.display = 'none';
                    soundBtn.classList.remove('unmuted');
                    soundBtn.setAttribute('data-tooltip', 'Activar sonido');
                } else {
                    mutedIcon.style.display = 'none';
                    unmutedIcon.style.display = 'block';
                    soundBtn.classList.add('unmuted');
                    soundBtn.setAttribute('data-tooltip', 'Desactivar sonido');
                }
            }

            // Event listeners para el bot√≥n de sonido
            soundBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleSound();
            });

            // Click en el video tambi√©n activa/desactiva el sonido
            video.addEventListener('click', () => {
                toggleSound();
            });

            // Intentar reproducir autom√°ticamente
            const autoplay = async () => {
                try {
                    await video.play();
                    console.log('‚úÖ Video reproduciendo autom√°ticamente (muted)');
                } catch (error) {
                    console.error('‚ùå Error en autoplay:', error);
                    // Intentar nuevamente en la primera interacci√≥n
                    const playOnInteraction = () => {
                        video.play().catch(() => {});
                        document.removeEventListener('click', playOnInteraction);
                        document.removeEventListener('touchstart', playOnInteraction);
                    };
                    document.addEventListener('click', playOnInteraction, { once: true });
                    document.addEventListener('touchstart', playOnInteraction, { once: true });
                }
            };

            // Iniciar autoplay cuando el DOM est√© listo
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', autoplay);
            } else {
                autoplay();
            }

            // Manejar visibilidad de la p√°gina
            document.addEventListener('visibilitychange', () => {
                if (!document.hidden && video.paused) {
                    video.play().catch(() => {
                        console.log('No se pudo reanudar el video');
                    });
                }
            });

            // Actualizar barra de progreso
            const updateProgress = () => {
                if (!isNaN(video.duration) && video.duration > 0) {
                    progressBar.style.width = (video.currentTime / video.duration) * 100 + '%';
                } else {
                    progressBar.style.width = '0%';
                }
            };

            video.addEventListener('timeupdate', updateProgress);
            video.addEventListener('loadedmetadata', updateProgress);
            video.addEventListener('seeking', updateProgress);
            video.addEventListener('seeked', updateProgress);
            video.addEventListener('ratechange', updateProgress);
            video.addEventListener('ended', () => { 
                progressBar.style.width = '0%'; 
            });

            // Inicializar visualizaci√≥n del bot√≥n
            updateSoundButton();

            // Log de eventos para debugging
            video.addEventListener('play', () => console.log('‚ñ∂Ô∏è Video iniciado'));
            video.addEventListener('pause', () => console.log('‚è∏Ô∏è Video pausado'));
            video.addEventListener('volumechange', () => {
                console.log('üîä Volumen:', video.muted ? 'Muted' : 'Unmuted');
                updateSoundButton();
            });
        }

        // Inicializar todo
        document.addEventListener('DOMContentLoaded', () => {
            new StepperForm();
            initVideoPlayer();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fechaOrigen').min = today;
            document.getElementById('fechaDestino').min = today;
        });
    </script>
</body>
</html>